# Auto Switch Theme W11 v1.5.1

## üá∑üá∫ –†—É—Å—Å–∫–∏–π

### üõ°Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–í–µ—Ä—Å–∏—è 1.5.1** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–∞–∂–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

#### üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **–£–°–¢–†–ê–ù–ï–ù–´ –°–ë–û–ò EXPLORER.EXE** - –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞–Ω—ã –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –æ–∫–Ω–∞–º–∏
- **–£–°–¢–†–ê–ù–ï–ù–û –ú–ï–†–¶–ê–ù–ò–ï –≠–ö–†–ê–ù–ê** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤ UI
- **–ë–ï–ó–û–ü–ê–°–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê** - —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–£–í–ï–õ–ò–ß–ï–ù–´ –¢–ê–ô–ú–ê–£–¢–´** - 500–º—Å –≤–º–µ—Å—Ç–æ 50-100–º—Å –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **–î–û–ë–ê–í–õ–ï–ù–´ –ü–ê–£–ó–´** - 100-200–º—Å –º–µ–∂–¥—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–±–æ–µ–≤
- **–°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–¨ –ü–†–ï–í–´–®–ï –°–ö–û–†–û–°–¢–ò** - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

#### üöÄ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–æ–≤** - –ø–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–Ω–æ–≥–æ–º–æ–Ω–∏—Ç–æ—Ä–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ** –≤—Å–µ—Ö –º–æ–Ω–∏—Ç–æ—Ä–æ–≤ –∏ –æ–∫–æ–Ω –ø–∞–Ω–µ–ª–∏ –∑–∞–¥–∞—á
- **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –Ω–∞ –≤—Å–µ—Ö –º–æ–Ω–∏—Ç–æ—Ä–∞—Ö
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏

#### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- **–í–µ—Ä—Å–∏—è 1.4.0**: ~1500–º—Å –∑–∞–¥–µ—Ä–∂–∫–∞, –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã, —Å–±–æ–∏ Explorer.exe
- **–í–µ—Ä—Å–∏—è 1.5.0**: <200–º—Å –∑–∞–¥–µ—Ä–∂–∫–∞, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –Ω–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ
- **–í–µ—Ä—Å–∏—è 1.5.1**: ~1000–º—Å –∑–∞–¥–µ—Ä–∂–∫–∞, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –ø–æ–ª–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

#### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
1. –ó–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ä–µ–µ—Å—Ç—Ä Windows
2. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
   - WM_SETTINGCHANGE —Å —Ç–∞–π–º–∞—É—Ç–æ–º 500–º—Å
   - –ü–∞—É–∑–∞ 100–º—Å
   - WM_THEMECHANGED —Å —Ç–∞–π–º–∞—É—Ç–æ–º 500–º—Å
   - –ü–∞—É–∑–∞ 100–º—Å
   - WM_SYSCOLORCHANGE —Å —Ç–∞–π–º–∞—É—Ç–æ–º 500–º—Å
   - –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–∞—É–∑–∞ 200–º—Å –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏
3. –û–±—â–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ ~1 —Å–µ–∫—É–Ω–¥–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
4. –ù–∏–∫–∞–∫–æ–≥–æ –ø—Ä—è–º–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤ Explorer.exe –∏–ª–∏ –æ–∫–Ω–∞ –ø–∞–Ω–µ–ª–∏ –∑–∞–¥–∞—á

---

## üá∫üá∏ English

### üõ°Ô∏è Critical Security Fixes

**Version 1.5.1** represents a crucial security update focused on resolving critical system stability issues.

#### üîß Key Fixes:
- **FIXED EXPLORER.EXE CRASHES** - completely removed aggressive window manipulation methods
- **ELIMINATED SCREEN FLICKERING** - safe synchronization without direct UI interference
- **SECURE ARCHITECTURE** - only basic system notifications
- **INCREASED TIMEOUTS** - 500ms instead of 50-100ms for maximum stability
- **ADDED PAUSES** - 100-200ms between notifications to prevent crashes
- **STABILITY OVER SPEED** - security priority over performance

#### üöÄ New Features:
- **Monitor diagnostics** - detailed multi-monitor configuration analysis
- **Automatic detection** of all monitors and taskbar windows
- **Guaranteed synchronization** across all monitors
- **Optimized architecture** for maximum performance

#### üìä Performance Comparison:
- **Version 1.4.0**: ~1500ms delay, aggressive methods, Explorer.exe crashes
- **Version 1.5.0**: <200ms delay, optimized methods, but unstable
- **Version 1.5.1**: ~1000ms delay, safe methods, complete stability

#### üõ°Ô∏è Safe Synchronization System:
1. Write values to Windows registry
2. Safe system notifications:
   - WM_SETTINGCHANGE with 500ms timeout
   - 100ms pause
   - WM_THEMECHANGED with 500ms timeout
   - 100ms pause
   - WM_SYSCOLORCHANGE with 500ms timeout
   - Final 200ms pause for stabilization
3. Total delay ~1 second for maximum stability
4. No direct interference with Explorer.exe or taskbar windows

---

## üì¶ Downloads

### Windows x64
- **Installer**: `AutoSwitchThemeW11-Setup.exe` (50.8 MB)
- **Portable**: `AutoSwitchThemeW11.exe` + dependencies

### System Requirements
- Windows 10/11 x64
- .NET 8 Runtime (included in installer)
- 100 MB free disk space

## üîß Installation

1. Download and run `AutoSwitchThemeW11-Setup.exe`
2. Follow the installation wizard
3. The application starts automatically in system tray
4. Right-click tray icon to access menu

## üÜò Support

- **GitHub Issues**: [Report bugs or request features](https://github.com/ohjohnnyoh/AutoSwitchThemeW11/issues)
- **Documentation**: See README.md for detailed usage instructions
- **Logs**: Check `%APPDATA%\AutoSwitchThemeW11\app.log` for troubleshooting

---

**Author**: @ohjohnnyoh  
**License**: MIT  
**GitHub**: https://github.com/ohjohnnyoh/AutoSwitchThemeW11
